var mvc=function(d){var i,f,b,h,c,g,a,e;i=mvc.events();f=mvc.dependencies();g=mvc.values(f);b=mvc.models(i,f);h=mvc.views(i,f);c=mvc.controllers(i,f);e=mvc.exports(i);a=mvc.imports(mvc,f);if(!d){throw new Error("No config object found")}if(d.imports){a(d.imports)}if(d.values){g(d.values)}if(d.models){b(d.models)}if(d.views){h(d.views)}if(d.controllers){c(d.controllers)}if(d.exports){return e(d.exports)}};mvc.models=function(a,c){var b;b=function(d){if(!d){throw new Error("No models found")}_.each(d,function(e,f){if(!e.facade){throw new Error("No facade found on "+f+" model")}c.register(f,e.facade);e.facade.dispatch=a.dispatch;if(e.requires){c.inject(e.facade,e.requires)}if(e.facade.init){e.facade.init()}})};return b};mvc.views=function(a,c){var d,e,b;d=function(f,g){if(!f.mediator){throw new Error("No mediator object found for "+g+" view")}if(f.element){f.mediator.element=f.element}if(f.requires){c.inject(f.mediator,f.requires)}f.mediator.dispatch=a.dispatch;if(f.mediator.init){f.mediator.init()}};e=function(f){_.each(_.functions(f.mediator),function(g){if(g!=="init"&&g!=="dispatch"){a.listen(g,f.mediator[g],f.mediator)}})};b=function(f){if(!f){throw new Error("A view object must be passed")}_.each(f,function(g,h){e(g,h);d(g)})};return b};mvc.controllers=function(b,d){var a,c;a={dispatch:b.dispatch};c=function(e){_.each(e,function(f,g){if(!_.isFunction(f.command)){throw new Error("No command function found on "+g+" controller")}if(f.requires&&!_.isArray(f.requires)){throw new Error("requires property for "+g+" controller must be an array of strings")}if(f.requires){d.inject(a,f.requires)}b.listen(g,f.command,a)})};return c};mvc.values=function(b){var a;a=function(c){if(!c){throw new Error("No values defined")}_.each(c,function(e,d){b.register(d,e)})};return a};mvc.plugins=function(b,c){var d,a;d={};a={dispatch:b.dispatch,listen:b.listen,dependencies:c};return{register:function(e){_.extend(d,e)},apply:function(e){_.each(e,function(g,f){if(d[f]){d[f].call(a,g)}})}}};mvc.exports=function(c){var a,b,d;a={},b={dispatch:c.dispatch,listen:c.listen};d=function(e){_.each(e,function(g,f){a[f]=function(){g.apply(b,arguments)}});return a};return d};mvc.imports=function(c,b){var a;if(!_.isFunction(c)){throw new Error("no init function found")}if(!b){throw new Error("no dependency object found")}a=function(d){_.each(d,function(g,f){var e=c(g);b.register(f,e)})};return a};mvc.events=function(){var e,c,d,b,a;e={};c=function(g,h,f){d(g);a(h);if(!e[g]){e[g]=[]}e[g].push({fn:h,context:f})};d=function(f){if(typeof f!=="string"){throw new Error(f+" should be a string.")}};b=function(f){if(f&&!_.isArray(f)){throw new Error(f+" should be an array.")}};a=function(f){if(!_.isFunction(f)){throw new Error(f+" should be a function.")}};return{dispatch:function(f,g){d(f);b(g,f);if(e[f]){_.each(e[f],function(i){var h=i.context||this;i.fn.apply(h,g)})}},listen:function(g,h,f){c(g,h,f)}}};mvc.dependencies=function(){var e,d,a,b,c;e={};d=function(f){if(!_.isString(f)){throw new Error(f+" should be a string")}if(e[f]){throw new Error(f+" already exists")}};a=function(g,f){if(!g){throw new Error(f+" does not exist as a registered dependency.")}};b=function(f){if(!f){throw new Error("No target defined")}};c=function(f){if(!_.isArray(f)){throw new Error(f+" should be an array")}};return{inject:function(g,f){b(g);c(f);_.each(f,function(h){g[h]=e[h]})},register:function(g,f){a(f,g);d(g);e[g]=f}}};